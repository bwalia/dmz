# MOVED TO NGINX-CONF.D/HEALTHDATA.CONF


        # default_type text/html;
        # return 200 "Edgeone host header validation failed. Please refer to the Technical Documentation!";

# #proxy_cache_path /var/cache/nginx/proxy_c max_size=8g use_temp_path=on keys_zone=one:16m;
# #proxy_cache_min_uses 3;
# proxy_buffering on;

# server {
#   listen 80;
#   listen [::]:80;
#   server_name localhost 127.0.0.1;
#   location /nginx_status {
#      stub_status on;
#      allow 127.0.0.1;
#      deny all;
#   }
# }

# server {
#   listen 80;
#   listen [::]:80;

#   server_name hd4dp.dmz.it.com www.hd4dp.dmz.it.com rprox.dmz.it.com rproxacc.dmz.it.com;

#   return 301 https://$server_name$request_uri;
# }

# server {
#   listen 80;
#   listen [::]:80;

#   server_name hd4dp.be www.hd4dp.be;
#   return 301 https://hd4dp.dmz.it.com$request_uri;
# }

# proxy_cache_path /opt/nginx/prod_cache levels=1:2 keys_zone=prod_cache:10m inactive=24h;

# server {
#   listen 443 ssl;
#   listen [::]:443 ssl;
#   server_name hd4dp.dmz.it.com www.hd4dp.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   error_page 480 /error.html;

#   location /proxy/swagger-ui {
#   allow  10.2.108.0/24;
#   allow  10.2.105.0/24;
#   deny   all;
#   return 403 "Access Denied";
#   }

#   location  /api/externalreference/consultrn/searchPersonBySsin {
#   return 403 "Access Denied";
#   }

#   location / {
#     if ($http_user_agent ~ MSIE) {
#       return 480;
#     }

#     if ($http_user_agent ~ 'rv:11') {
#       return 480;
#     }

#     proxy_pass https://10.72.128.47/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Forwarded-Host $host;
#     proxy_set_header X-Forwarded-Port $server_port;
#     proxy_set_header X-Forwarded-Proto $scheme;

#   }

#   location /error.html {
#     root /var/www/html/healthdata/error;
#   }

# }

# server {
#   listen 80;
#   listen [::]:80;

#   server_name hd4dp-arch2-acc.dmz.it.com;

#   return 301 https://$server_name$request_uri;
# }

# server {
#   listen 443 ssl;
#   listen [::]:443 ssl;
#   server_name hd4dp-arch2-acc.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   location / {
#     if ($http_user_agent ~ MSIE) {
#       return 480;
#     }

#     if ($http_user_agent ~ 'rv:11') {
#       return 480;
#     }

#     proxy_pass https://10.72.128.42/;
#     proxy_read_timeout 10s;
#     proxy_connect_timeout 10s;
#     proxy_send_timeout 10s;
#     proxy_http_version 1.1;
#     proxy_set_header Upgrade $http_upgrade;
#     proxy_set_header Connection 'upgrade';
#     proxy_set_header Host $host;
#     proxy_set_header X-Forwarded-Host $host;
#     proxy_set_header X-Forwarded-Port $proxy_protocol_port;
#     proxy_set_header X-Forwarded-Proto $scheme;
#     proxy_cache_bypass $http_upgrade;

#   }
# }

# server {
#   listen 80;
#   listen [::]:80;

#   server_name hd4dp2-demo.dmz.it.com;

#   return 301 https://$server_name$request_uri;
# }

# server {
#   listen 443 ssl;
#   listen [::]:443 ssl;
#   server_name hd4dp2-demo.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   location / {
#     if ($http_user_agent ~ MSIE) {
#       return 480;
#     }

#     if ($http_user_agent ~ 'rv:11') {
#       return 480;
#     }

#     proxy_pass https://10.72.130.36/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Forwarded-Host $host;
#     proxy_set_header X-Forwarded-Port $server_port;
#     proxy_set_header X-Forwarded-Proto $scheme;
#   }
# }

# server {
#   listen 80;
#   listen [::]:80;

#   server_name hd4dp2-uat.dmz.it.com;

#   return 301 https://$server_name$request_uri;
# }

# server {
#   listen 443 ssl;
#   listen [::]:443 ssl;
#   server_name hd4dp2-uat.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   location / {
#     if ($http_user_agent ~ MSIE) {
#       return 480;
#     }

#     if ($http_user_agent ~ 'rv:11') {
#       return 480;
#     }

#     proxy_pass https://10.72.130.37/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Forwarded-Host $host;
#     proxy_set_header X-Forwarded-Port $server_port;
#     #proxy_set_header X-Forwarded-Proto $scheme;

#   }
# }

# server {
#   listen 8080 ssl;
#   listen [::]:8080 ssl;

#   server_name rprox.dmz.it.com, rproxacc.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

# #  auth_basic "Administratorâ€™s Area";
# #  auth_basic_user_file /etc/nginx/.htpasswd;

#   location / {
#     proxy_pass http://10.72.128.45:1234/;
#   }
# }

# server {
#   listen 18080 ssl;
#   listen [::]:18080 ssl;

#   server_name rproxacc.dmz.it.com rprox.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   location /hddockerscript/ {
#     if ($http_user_agent !~ "J87PsHbaKAgTmhsWbnnn9XnTkzHH" ) {
#       return 403;
#     }
#     proxy_pass http://10.72.128.45:8080/repository/hd-files/dockerinstaller/prod/hd-installer.deb;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#   }

#   location /{
#     if ($http_user_agent !~ "(docker|containerd)" ) {
#       return 404;
#     }
#     proxy_pass http://10.72.128.45:18080/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#   }
# }

# upstream hdintegrationproxy {
#   server 10.72.128.46:8080;
# }

# server {
#   listen 443 ssl;
#   listen [::]:443 ssl;
#   port_in_redirect on;
#   server_name rprox.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   #location /actuator/health {
#   #	return 200;
#   #}

#   location / {
#     proxy_pass http://hdintegrationproxy;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

#     #set $proxy_pass_backend  "10.72.128.46:8080";

#     #if ($http_s3_bucket !~ "authorgroups" ) {
#     #     set $proxy_pass_backend "10.72.128.5:9000";
#     #}
#     #proxy_pass http://$proxy_pass_backend;
#     #proxy_set_header Host $http_host;
#     #proxy_set_header X-Real-IP $remote_addr;
#     #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     #proxy_set_header X-Forwarded-Proto $scheme;

#   }

#   location /api/installation/extended-info {
#     #expires 1m;
#     proxy_pass http://10.72.128.46:8080;
#     #proxy_ignore_headers "Set-Cookie" "Cache-Control" "Expires";
#     #proxy_hide_header "Set-Cookie";
#     #proxy_hide_header "Cache-Control";
#     #proxy_set_header Host $host;
#     #proxy_buffering off;
#     #proxy_cache prod_cache;
#     #proxy_cache_valid 200 10m;
#     #proxy_cache_use_stale error timeout http_500 http_502 http_503 http_504 http_429;
#     #proxy_cache_lock on;
#     #add_header X-Cached $upstream_cache_status;
#   }

#   location /api/installation/participation {
#     #expires 1m;
#     proxy_pass http://10.72.128.46:8080;
#     #proxy_ignore_headers "Set-Cookie" "Cache-Control" "Expires";
#     #proxy_hide_header "Set-Cookie";
#     #proxy_hide_header "Cache-Control";
#     #proxy_set_header Host $host;
#     #proxy_buffering on;
#     #proxy_cache prod_cache;
#     #proxy_cache_valid 200 10m;
#     #proxy_cache_use_stale error timeout http_500 http_502 http_503 http_504 http_429;
#     #proxy_cache_lock on;
#     #add_header X-Cached $upstream_cache_status;
#   }

#   location /dynatrace_agent {
#     proxy_pass https://lkq63483.live.dynatrace.com/api/v1/deployment/installer/agent/unix/default/latest?arch=x86&flavor=default;
#   }

#   location /dynatrace-root.cert.pem {
#     proxy_pass https://ca.dynatrace.com/dt-root.cert.pem;
#   }

#   location /monitoring/ {
#     #return 403;
#     if ($http_user_agent !~ "v89TiJbVQUweaa7Bb3tFtW2KQdGb" ) {
#       return 403;
#     }
#     proxy_pass http://10.72.128.55:8086/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#   }
#   location /write/ {
#     #return 403;
#     if ($http_user_agent !~ "v89TiJbVQUweaa7Bb3tFtW2KQdGb" ) {
#       return 403;
#     }
#     proxy_pass http://10.72.128.55:8086/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#   }
#   location /s3/ {
#     rewrite ^/s3/(.*) /$1 break;
#     proxy_pass http://10.72.128.5:9000;
#     proxy_set_header Host $http_host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header X-Forwarded-Proto $scheme;
#   }

#   location /authorgroups/ {
#     proxy_pass http://10.72.128.5:9000;
#     proxy_set_header Host $http_host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header X-Forwarded-Proto $scheme;
#   }

# }

# proxy_cache_path /data/nginx/cache levels=1:2 keys_zone=acceptance_cache:10m inactive=24h;

# map $request_method $purge_method {
#    PURGE   1;
#    default 0;
# }

# server {
#   listen 443 ssl;
#   listen [::]:443 ssl;
#   server_name rproxacc.dmz.it.com;

#   ssl_protocols TLSv1.2 TLSv1.3;

#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;

#   location / {
#     proxy_pass http://10.72.130.163:8080/;
#     proxy_read_timeout 120s;
#     proxy_connect_timeout 120s;
#     proxy_send_timeout 120s;
#   }

#   location /actuator/health {
#         return 200;
#   }

#   location /api/installation/extended-info {
#     #expires 1m;
#     proxy_pass http://10.72.130.163:8080;
#     #proxy_ignore_headers "Set-Cookie" "Cache-Control" "Expires";
#     #proxy_hide_header "Set-Cookie";
#     #proxy_hide_header "Cache-Control";
#     #proxy_set_header Host $host;
#     #proxy_buffering on;
#     #proxy_cache acceptance_cache;
#     #proxy_cache_valid 200 10m;
#     #proxy_cache_use_stale error timeout http_500 http_502 http_503 http_504 http_429;
#     #proxy_cache_lock on;
#     #add_header X-Cached $upstream_cache_status;
#   }

#   location /api/installation/participation {
#     #expires 1m;
#     proxy_pass http://10.72.130.163:8080;
#     #proxy_ignore_headers "Set-Cookie" "Cache-Control" "Expires";
#     #proxy_hide_header "Set-Cookie";
#     #proxy_hide_header "Cache-Control";
#     #proxy_set_header Host $host;
#     #proxy_buffering on;
#     #proxy_cache acceptance_cache;
#     #proxy_cache_valid 200 10m;
#     #proxy_cache_use_stale error timeout http_500 http_502 http_503 http_504 http_429;
#     #proxy_cache_lock on;
#   }
# }

# # Redirect service to service-now support page
# server {
#   listen 80;
#   listen [::]:80;
#   server_name support.dmz.it.com;
#   return 301 https://sciensano.service-now.com/sp;
# }

# server {
#   listen 443;
#   listen [::]:443;
#   server_name support.dmz.it.com;
#   ssl_protocols TLSv1.2 TLSv1.3;
#   ssl_certificate /etc/ssl/certs/star_healthdata_be.bundle;
#   ssl_certificate_key /etc/ssl/private/star_healthdata_be.key;
#   return 301 https://sciensano.service-now.com/sp;
# }


# BW 29 Oct 2024 19:00hrs note these lime survey servers are not in use anymore as moved to dynamic nginx conf
# Lime-survey BEGIN
#     upstream azure_healthdata_lb_http_upstream {

#         server 10.33.139.250;

#     }

#     upstream arxus_healthdata_lb_http_upstream {
#         # server 10.72.131.7:30748;
#         server 10.72.128.56:443;
#     }

#     upstream azure_healthdata_lb_https_upstream {

#         server 10.33.139.250:443;

#     }
#     server {
#         listen *:80;
#         server_name lime-prd.dmz.it.com;
#         error_page    500 502 503 504  /50x.html;
#         access_log /var/log/nginx/access.log main;
#         error_log  /var/log/nginx/error.log;
#         access_log  on;
#         error_log on;
#         ssl_protocols TLSv1.2 TLSv1.3;
#         include /opt/nginx/conf.d/includes/https_proxyssl_origins.conf;
#         include /opt/nginx/conf.d/includes/https_healthdata.conf;

#         location / {
#             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#             proxy_set_header X-Real-IP $remote_addr;
#             proxy_set_header Host $host;
#             #return 200 "Lime-survey is under maintenance $host";
#             proxy_pass https://arxus_healthdata_lb_http_upstream;
#         }
#     }

#     server {
#         listen *:80;
#         server_name lime.dmz.it.com;
#         error_page    500 502 503 504  /50x.html;
#         access_log /var/log/nginx/access.log main;
#         error_log  /var/log/nginx/error.log;
#         access_log  on;
#         error_log on;
#         ssl_protocols TLSv1.2 TLSv1.3;
#         include /opt/nginx/conf.d/includes/https_proxyssl_origins.conf;
#         include /opt/nginx/conf.d/includes/https_healthdata.conf;

#         location / {
#             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#             proxy_set_header X-Real-IP $remote_addr;
#             proxy_set_header Host $host;
#             #return 200 "Lime-survey is under maintenance $host";
#             proxy_pass https://arxus_healthdata_lb_http_upstream;
#         }
#     }

#     server {
#         listen *:80;
#         server_name lime-sandbox.dmz.it.com lime-acc.dmz.it.com;
#         error_page    500 502 503 504  /50x.html;
#         access_log /var/log/nginx/access.log main;
#         error_log  /var/log/nginx/error.log;
#         access_log  on;
#         error_log on;
#         ssl_protocols TLSv1.2 TLSv1.3;
#         include /opt/nginx/conf.d/includes/https_proxyssl_origins.conf;
#         include /opt/nginx/conf.d/includes/https_healthdata.conf;

#         location / {
#             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#             proxy_set_header X-Real-IP $remote_addr;
#             proxy_set_header Host $host;
#             #return 200 "Lime-survey is under maintenance $host";
#             proxy_pass https://azure_healthdata_lb_https_upstream;
#         }
#     }

# Lime-survey END